---
layout: post
title: 写了十几年代码，说说我怎么高效利用 AI 编程的
tags: [AI, vibe-coding, Claude Code, 工作流]
---

说几句实话。写了十几年代码，过去一年基本全靠 AI 写，做了好几个完整项目上线。

结论先放这儿：**高效利用 AI 编程的核心不是"用什么工具"，而是"你怎么控场"。**

工具选错顶多慢一点，控场出问题整个项目都会崩。

---

## 一、别急着写代码，先把刹车装好

AI 写代码太快了。这恰恰是最大的坑。

你一句话它能改二十个文件，改完你都不知道它改了什么。一旦写崩了，你连回退到哪个版本都找不到。

所以我的工作流第一步永远是：**Git 刹车系统**。

```bash
# AI 改完先看它改了什么
git status
git diff

# 确认没问题，小步提交
git add .
git commit -m "feat: 用户登录接口"

# 大改之前先开分支
git switch -c feature/new-module
```

写崩了？回主线、删分支，心态和代码都干干净净：

```bash
git switch main
git branch -D feature/new-module
```

**这不是高级技巧，这是活命手段。** 我见过太多人让 AI 一口气改完整个项目，然后发现跑不起来，又回不去。

---

## 二、给 AI 写"规矩文件"，比写提示词重要十倍

大部分人用 AI 编程就是一句句 prompt 往上怼。这在改个小 bug 的时候没问题，做项目就完蛋。

因为 AI 没有上下文记忆。你第三次对话的时候，它已经忘了第一次你说的技术栈选型。

解决方案：**在项目根目录放规矩文件。**

我每个项目都有一个 `CLAUDE.md`（或者叫 `AGENTS.md`），里面写清楚：

- 技术栈：后端 FastAPI + SQLAlchemy，前端 Next.js + Tailwind
- 目录结构：core/api/domain/adapters/services 分层
- 提交规范：feat/fix/docs 前缀，一次只做一件事
- 禁止事项：不准用 `SELECT *`，不准在 controller 里写业务逻辑

AI 每次启动都会读这个文件。效果立竿见影——它写出来的代码风格统一、结构清晰，不再东一榔头西一棒子。

**你给 AI 的约束越明确，它的输出质量越高。** 这跟带团队一个道理：规矩不是限制人，是减少返工。

---

## 三、文档先行，不是口号

我做任何功能之前，都是先让 AI 出设计文档，不是直接写代码。

流程是这样的：

1. 我描述需求（一段话就行）
2. AI 输出设计文档：接口定义、数据模型、依赖关系、边界情况
3. 我审核文档，砍掉不靠谱的部分，补上遗漏的
4. 文档确认后，再让 AI 按文档写代码

为什么要多这一步？

因为 **AI 写文档比写代码更容易暴露问题**。你让它直接写代码，它能把一个根本不存在的 API 调用写得语法完美，你不看文档根本发现不了。但如果先出文档，你在审核阶段就能发现"这个接口参数不对"或者"这个依赖根本不该引入"。

我在做 Orion（一个统一通知网关）的时候，这套流程救了我很多次。AI 的设计文档里有三次明显的架构错误，都是在文档审核阶段抓出来的。如果直接写代码，这些问题可能上线之后才爆。

---

## 四、竖切，不要横切

这是我踩过最大的坑。

刚开始用 AI 的时候，我喜欢"先把所有模型建好，再写所有接口，再写所有前端页面"——**横切**。

结果就是：模型建了一堆，接口写到一半发现模型设计有问题，前端还没开始就要推翻重来。

现在我的做法是**竖切**：

> 一次只做一条完整链路。

比如做一个用户管理系统：
- 第一刀：注册接口 → 数据库表 → 前端注册页 → 能跑
- 第二刀：登录接口 → JWT → 前端登录页 → 能跑
- 第三刀：权限控制 → 中间件 → 前端路由守卫 → 能跑

每一刀下去，都有一个能跑的东西可以验收。验收通过了，commit，再切下一刀。

AI 特别适合这种工作方式——你给它一条明确的链路，它能一口气写完。但你给它一个模糊的大需求，它就开始乱来。

---

## 五、别信"一句话做出 App"

这是目前 AI 编程营销最大的谎言。

一句话确实能做出一个 Demo。但 Demo 和产品之间差着十万八千里：

- **限流**：你的 API 会被刷爆吗？
- **错误处理**：用户输入乱码会怎样？
- **部署**：Docker 配了吗？环境变量管了吗？HTTPS 上了吗？
- **数据备份**：数据库挂了你恢复得了吗？

这些东西 AI 不会主动帮你想。**你不问，它不说。**

我做 agentskill.work 的时候，"半天上线"是真的。但那半天里我最重要的工作不是让 AI 写代码，而是盯住这些关键节点：抓取限流、Celery 定时任务、Nginx 配置、证书申请、Docker Compose 编排。

AI 是施工队，你是总工。施工队干活快不代表工程质量高——得有人盯着。

---

## 六、工具推荐（实际用过的）

| 工具 | 适合场景 | 我的评价 |
|------|---------|---------|
| Claude Code | 完整项目开发、重构 | 代码理解能力最强，适合大项目 |
| Codex | 批量任务、自动化 | 后台跑，适合不需要实时交互的活 |
| Cursor | IDE 集成 | 改 bug、小功能很方便 |

我个人主力是 Claude Code，原因很简单：它能读懂整个代码库，不需要你每次都解释上下文。配合 `CLAUDE.md` 规矩文件，写出来的东西基本能直接用。

Codex 我用来跑一些"不紧急但要做"的任务，比如给全项目加单元测试、统一代码风格、批量重命名。丢给它跑就行，回头看结果。

---

## 七、一句话总结

高效利用 AI 编程 = **控场能力 × 工具效率**。

工具效率是乘数，控场能力是底数。底数为零，乘什么都是零。

先学会 Git、学会写规矩文件、学会审核 AI 的输出、学会竖切需求。这些搞定了，不管用什么工具，效率都不会差。

---

> 我在博客 [yfge.github.io](https://yfge.github.io) 上写了一套完整的 vibe-coding 九阳神功系列（夯、抄、学、喂、规、验、测、扩、收），是从实际项目里总结出来的方法论。感兴趣的可以看看，不收费。
